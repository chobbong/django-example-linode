{% extends 'base.html' %}

{% block content %}
<form method="get" action="{% url 'search' %}">
    <input type="text" name="query" placeholder="단지명을 입력하세요...">
    <input type="submit" value="검색">
</form>

<!-- Google Maps Container -->
<div id="map" style="height: 500px;"></div>

<script>
// Your modified JavaScript for Google Maps
let map;

function initMap() {
  const locations = {{ locations|safe }}; // Get data from Django
  const center = locations.length > 0 ? locations[0] : { lat: 37.5665, lng: 126.9780 }; // Seoul as default

  map = new google.maps.Map(document.getElementById("map"), {
    zoom: 12,
    center: center,
  });

  locations.forEach(location => {
    const marker = new google.maps.Marker({
      map: map,
      position: location,
      title: location.name,
    });

    marker.addListener('click', function() {
      // Display property details when marker is clicked
      const infoWindow = new google.maps.InfoWindow({
        content: `<h3>${location.name}</h3>
                  <p><strong>시군구:</strong> ${location.시군구}</p>
                  ...` // Add other details as needed
      });
      infoWindow.open(map, marker);
    });
  });
}

initMap();
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB5GPHVbAcjS8yiINFJ0e9KUVUPFwV_2LY&callback=initMap"></script>
{% endblock %}
